import{r as e,o as t,c as r,a as o,b as l,d as a,w as s,e as n,u,F as i,f as c,t as d,g as v,n as m,h as p,i as f,j as h,k,l as y,m as g,p as w,q as b,s as _,v as C,x,y as S}from"./vendor.e550da09.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const M={__name:"App",setup:o=>(o,l)=>{const a=e("router-view");return t(),r(a)}};const A={class:"sudoku-home"},E={class:"menu-container"},D={__name:"Home",setup(r){const u=()=>{console.log("退出游戏")};return(r,i)=>{const c=e("router-link");return t(),o("div",A,[i[3]||(i[3]=l("h2",{class:"menu-title"},"数独",-1)),l("div",E,[a(c,{class:"menu-item",to:"/level"},{default:s((()=>[...i[0]||(i[0]=[n("开始游戏",-1)])])),_:1}),a(c,{class:"menu-item",to:"/setting"},{default:s((()=>[...i[1]||(i[1]=[n("游戏设置",-1)])])),_:1}),a(c,{class:"menu-item",to:"/pojie"},{default:s((()=>[...i[2]||(i[2]=[n("破解数独",-1)])])),_:1}),l("div",{class:"menu-item exit-btn",onClick:u},"退出")])])}},__scopeId:"data-v-4e9785aa"},N={format(e,t="YYYY-MM-DD"){const r=new Date(e),o=e=>String(e).padStart(2,"0");return t.replace(/YYYY/g,r.getFullYear()).replace(/MM/g,o(r.getMonth()+1)).replace(/DD/g,o(r.getDate())).replace(/HH/g,o(r.getHours())).replace(/mm/g,o(r.getMinutes())).replace(/ss/g,o(r.getSeconds())).replace(/ms/g,o(Math.floor(r.getMilliseconds()/10)))},dateDiff(e,t){const r=Math.abs(e-t);return{days:Math.floor(r/864e5),hours:Math.floor(r%864e5/36e5),minutes:Math.floor(r%36e5/6e4),seconds:Math.floor(r%6e4/1e3),milliseconds:Math.floor(r%1e3)}}},L={stringToSudokuArray(e){if("string"!=typeof e||81!==e.length)throw new Error("输入必须是一个包含81个数字的字符串");if(!/^\d+$/.test(e))throw new Error("字符串必须只包含数字");const t=[];for(let r=0;r<9;r++){const o=[];for(let t=0;t<9;t++){const l=parseInt(e.charAt(9*r+t),10);o.push(l)}t.push(o)}return t},sudokuArrayToString(e){if(!Array.isArray(e)||9!==e.length)throw new Error("输入必须是9x9的二维数组");let t="";for(let r=0;r<9;r++){if(!Array.isArray(e[r])||9!==e[r].length)throw new Error("每行必须是包含9个数字的数组");for(let o=0;o<9;o++){const l=e[r][o];if("number"!=typeof l||l<0||l>9||!Number.isInteger(l))throw new Error("数组元素必须是0-9的整数");t+=l.toString()}}return t},lvName(e){switch(Number(e)){case 0:return"见习学者";case 1:return"逻辑学士";case 2:return"推理硕士";case 3:return"数理博士";case 4:return"智慧院士"}return""},normalised:e=>e.map((e=>e.map((e=>({value:e,fixed:0!=e,error:!1,notes:[]}))))),area(e){let t=[];for(var r=0;r<9;r++){t[r]=[];for(var o=0;o<9;o++)t[r].push(e[r][o])}let l=[];for(r=0;r<9;r++){l[r]=[];for(o=0;o<9;o++)l[r].push(e[o][r])}let a=[];var s=0;for(r=0;r<3;r++)for(o=0;o<3;o++){a[s]=[];for(var n=0;n<3;n++)for(var u=0;u<3;u++)a[s].push(e[3*r+n][3*o+u]);s++}return[...t,...l,...a]},cError(e){e.forEach((e=>e.forEach((e=>e.error=!1)))),e.forEach((e=>{let t=Array(10).fill(0);e.forEach((e=>{t[e.value]++})),e.forEach((e=>{0!=e.value&&t[e.value]>1&&(e.error=!0)}))}))},removeNotes(e){e.forEach((e=>{let t=Array(10).fill(0);e.forEach((e=>{e.error||0==e.value||(t[e.value]=1)})),e.forEach((e=>{if(0==e.value)for(var r=1;r<=9;r++)1==t[r]&&(e.notes=e.notes.filter((e=>e!=r)))}))}))},isComplete:e=>e.every((e=>e.every((e=>e.value&&!e.error))))},I={async load(e){try{const t=await fetch("@/../levels/sudoku.json");if(!t.ok)throw new Error("关卡数据加载失败");const r=(await t.json()).levels.find((t=>t.difficulty==e));return r?r.puzzles:(console.warn(`没有找到难度 ${e} 的关卡`),[])}catch(t){return console.error("加载关卡时出错:",t),[]}}};const T={class:"sudoku-home"},$={class:"menu-container"},j=["onClick"],Y={__name:"Level",setup(e){const r=u(),a=()=>{r.go(-1)};return(e,s)=>(t(),o("div",T,[s[0]||(s[0]=l("h2",{class:"menu-title"},"难度等级",-1)),l("div",$,[(t(),o(i,null,c([0,1,2,3,4],(e=>l("div",{class:"menu-item",onClick:t=>{return o=e,void r.push({name:"LevelList",params:{lv:o}});var o},key:"l"+e},d(v(L).lvName(e)),9,j))),64)),l("div",{class:"menu-item back-bnt",onClick:a},"返回")])]))},__scopeId:"data-v-da633d18"},q={};q.render=function(e,r){return t(),o("div",null," 设置 ")};const F={};F.render=function(e,r){return t(),o("div",null," 破解数独 ")};const H={ref:"box",class:"box my_unselectable"},O={__name:"MiniSudoku",props:{sudokuArray:{default:()=>[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]]}},setup(e){const r=e;return(e,l)=>(t(),o("div",H,[(t(!0),o(i,null,c(r.sudokuArray,((e,r)=>(t(),o("div",{key:"y"+r,class:"row"},[(t(!0),o(i,null,c(e,((e,l)=>(t(),o("div",{key:"x"+l,class:m(["cell",(l+1)%3==0?"cell-bx":"",(r+1)%3==0?"cell-by":"",(Math.floor(l/3)+Math.floor(r/3))%2==0?"cell-b":""])},d(0==e?" ":e),3)))),128))])))),128))],512))},__scopeId:"data-v-9a44767a"};const B={class:"sudoku-home"},R={class:"title"},G={class:"box-container"},z=["onClick"],K={class:"index"},P={__name:"LevelList",props:{lv:{default:()=>0}},setup(e){const r=u(),s=e,n=p([]),m=()=>{r.go(-1)};return f((async()=>{let e=await I.load(s.lv);n.value=e.map((e=>L.stringToSudokuArray(e)))})),(e,u)=>(t(),o("div",B,[l("h2",R,"难度等级："+d(v(L).lvName(s.lv)),1),l("div",G,[(t(!0),o(i,null,c(n.value,((e,n)=>(t(),o("div",{class:"mini-box",onClick:t=>(e=>{r.push({name:"Game",query:{arrstr:L.sudokuArrayToString(e)}})})(e)},[a(O,{class:"mini","sudoku-array":e},null,8,["sudoku-array"]),l("div",K,d(Number(s.lv)+1+"-"+(n+1)),1)],8,z)))),256))]),l("div",{class:"back-bnt",onClick:m}," < ")]))},__scopeId:"data-v-27ae5fcc"};const J={class:"sudoku-container"},Q={class:"sudoku-grid"},U=["onClick"],V={key:0},W={key:1,class:"notes-box"},X={__name:"Sudoku",props:{arr:{type:Array,default:()=>Array(9).fill().map((()=>Array(9).fill({value:0,fixed:!1})))},selectedCell:{type:Object,default:()=>({row:null,col:null})}},emits:["cellClick"],setup(e,{emit:r}){const a=e,s=r,n=p({row:null,col:null}),u=(e,t)=>{const r=null!==a.selectedCell.row?a.selectedCell:n.value;return null!==r.row&&null!==r.col&&(e===r.row||t===r.col||Math.floor(e/3)===Math.floor(r.row/3)&&Math.floor(t/3)===Math.floor(r.col/3))},v=(e,t)=>{const r=null!==a.selectedCell.row?a.selectedCell:n.value;return e===r.row&&t===r.col};return f((()=>{})),(e,r)=>(t(),o("div",J,[l("div",Q,[(t(!0),o(i,null,c(a.arr,((e,r)=>(t(),o("div",{key:"row-"+r,class:"sudoku-row"},[(t(!0),o(i,null,c(e,((e,p)=>(t(),o("div",{key:"cell-"+r+"-"+p,class:m(["sudoku-cell",{highlighted:u(r,p),selected:v(r,p),"border-right-bold":(p+1)%3==0,"border-bottom-bold":(r+1)%3==0,fixed:e.fixed,error:e.error}]),onClick:e=>((e,t)=>{null!==a.selectedCell.row||(n.value={row:e,col:t}),s("cellClick",{row:e,col:t})})(r,p)},[e.value?(t(),o("div",V,d(e.value),1)):(t(),o("div",W,[(t(),o(i,null,c(9,(t=>l("div",{class:"notes-item",key:"cell-"+r+"-"+p+"-"+t},d(e.notes[t-1]||""),1))),64))]))],10,U)))),128))])))),128))])]))},__scopeId:"data-v-22c05b88"};const Z={class:"num-keys-container"},ee={class:"number-keys"},te=["onMousedown","onTouchstart"],re={__name:"NumKeys",emits:["numDown","eraseDown"],setup(e,{emit:r}){const a=r,s=e=>{a("numDown",e)},n=()=>{a("eraseDown")};return(e,r)=>(t(),o("div",Z,[l("div",ee,[(t(),o(i,null,c(9,(e=>l("button",{key:e,class:"num-key",onMousedown:t=>s(e),onTouchstart:t=>s(e)},d(e),41,te))),64))]),r[1]||(r[1]=l("div",{class:"separator"},null,-1)),l("button",{class:"erase-key",onMousedown:n,onTouchstart:n,title:"擦除"},[...r[0]||(r[0]=[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M6 19L19 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),l("path",{d:"M6 6L19 19",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)])],32)]))},__scopeId:"data-v-0772e72f"};const oe={class:"notes-box"},le=["onClick"],ae={__name:"NotesBox",props:{selected:{type:Object,default:()=>{}}},emits:["noteClick"],setup(e,{emit:r}){const a=e,s=r;return(e,r)=>(t(),o("div",oe,[(t(),o(i,null,c(9,(e=>l("div",{class:m(["notes-item my_unselectable",-1!==a.selected.notes.indexOf(e)?"notes-item-had":""]),onClick:t=>s("noteClick",e)},d(e),11,le))),64))]))},__scopeId:"data-v-3105a923"};const se={class:"timer-container"},ne={class:"time-display"},ue={__name:"Timer",props:{isRunning:Boolean,startTime:Number},setup(e){const r=e,a=p(0);let s=null;const n=()=>{r.isRunning&&(a.value=Date.now()-r.startTime,s=requestAnimationFrame(n))};h((()=>r.isRunning),(e=>{e?n():cancelAnimationFrame(s)}),{immediate:!0});const u=k((()=>{let e=N.dateDiff(0,a.value);return`${e.hours.toString().padStart(2,"0")}:${e.minutes.toString().padStart(2,"0")}:${e.seconds.toString().padStart(2,"0")}.${Math.floor(e.milliseconds/10).toString().padStart(2,"0")}`}));return y((()=>{cancelAnimationFrame(s)})),(e,r)=>(t(),o("div",se,[r[0]||(r[0]=l("span",{class:"timer-icon"},"⏱️",-1)),l("span",ne,d(u.value),1)]))},__scopeId:"data-v-55d6be7a"};const ie={class:"sudoku-home"},ce={class:"headbox"},de={key:1,class:"win"},ve={class:"win-time"},me={class:"minibox"},pe={__name:"Game",setup(e){const s=g(),i=u(),c=p(null),m=p({});p([]);const h=p([]),y=p([]),_=p(!1),C=p({row:null,col:null}),x=p(!0),S=p(!1),M=p(Date.now()),A=p(0),E=k((()=>h.value.map((e=>e.map((e=>e.value)))))),D=()=>{i.go(-1)},I=({row:e,col:t})=>{if(C.value.row===e&&C.value.col===t){if(!Y().value){let e=c.value.getBoundingClientRect(),t=e.left,r=e.top,o=e.width,l=e.height,a=158,s=C.value.col,n=C.value.row;t+=s>4?o*s/9-a:o*(s+1)/9+1,r+=n>4?l*n/9-a:l*(n+1)/9+1,m.value={left:`${t}px`,top:`${r}px`},_.value=!_.value}}else C.value={row:e,col:t},_.value=!1},T=()=>{if(L.cError(y.value),L.removeNotes(y.value),x.value){L.isComplete(y.value)&&(x.value=!1,A.value=Date.now()-M.value,S.value=!0)}_.value=!1},$=()=>{S.value=!1},j=e=>{let t=N.dateDiff(0,e);return`${t.hours.toString().padStart(2,"0")}:${t.minutes.toString().padStart(2,"0")}:${t.seconds.toString().padStart(2,"0")}.${Math.floor(t.milliseconds/10).toString().padStart(2,"0")}`},Y=()=>{return e=C.value.row,t=C.value.col,h.value[e][t];var e,t},q=e=>{var t=Y();t.value!=e&&(t.value=e,T())},F=()=>{var e=Y();0==e.value||e.fixed?0==e.value&&(e.notes=[]):(e.value=0,T())},H=e=>{let t=Y(),r=t.notes;const o=r.indexOf(e);t.notes=-1!==o?r.filter((t=>t!==e)):[...r,e],t.notes.length>0&&"number"==typeof t.notes[0]&&t.notes.sort(((e,t)=>e-t))};return f((()=>{h.value=L.normalised(L.stringToSudokuArray(s.query.arrstr)),y.value=L.area(h.value),L.cError(y.value)})),(e,u)=>(t(),o("div",ie,[l("div",ce,[l("div",{class:"back-bnt",title:"返回",onClick:D}," ← "),a(ue,{"is-running":x.value,"start-time":M.value,style:{"margin-bottom":"30px"}},null,8,["is-running","start-time"])]),l("div",{ref_key:"sudokubox",ref:c},[a(X,{arr:h.value,onCellClick:I,"selected-cell":C.value},null,8,["arr","selected-cell"])],512),a(re,{onNumDown:q,onEraseDown:F,style:{"margin-top":"30px"}}),_.value?(t(),r(ae,{key:0,style:w(m.value),selected:Y()||{},onNoteClick:H},null,8,["style","selected"])):b("",!0),u[2]||(u[2]=l("div",{class:"tip"},"两次点击同一个单元格可做笔记",-1)),S.value?(t(),o("div",de,[u[1]||(u[1]=l("div",{class:"win-title"}," 数独完成 ",-1)),l("div",ve,[u[0]||(u[0]=n(" 耗时： ",-1)),l("div",null,d(j(A.value)),1)]),l("div",me,[a(O,{class:"mini","sudoku-array":v(L).stringToSudokuArray(v(s).query.arrstr)},null,8,["sudoku-array"]),a(O,{class:"mini","sudoku-array":E.value},null,8,["sudoku-array"])]),l("div",{class:"ctrlbox"},[l("div",{class:"back-bnt",onClick:$},"继续"),l("div",{class:"back-bnt",onClick:D},"返回")])])):b("",!0)]))},__scopeId:"data-v-58990cd8"},fe=[{path:"/",name:"Home",component:D},{path:"/level",name:"Level",component:Y},{path:"/setting",name:"Setting",component:q},{path:"/pojie",name:"Pojie",component:F},{path:"/level-list:lv?",name:"LevelList",component:P,props:!0},{path:"/game",name:"Game",component:pe}],he=_({history:C("/sudoku/"),routes:fe});const ke=x();S(M).use(he).use(ke).mount("#app");
